{# src/Minsal/SeguimientoBundle/Resource/views/SecIngreso/edit.html.twig #}
{% extends 'MinsalSiapsBundle::standard_layout.html.twig' %}
{% block stylesheets %}
    {{parent()}}
<link rel="stylesheet" href="{{ asset('bundles/minsalseguimiento/css/SecIngreso/edit.css') }}" type="text/css" media="all" />  
{%endblock%}
{%block javascripts %}
    {{parent()}}
<script src="{{ asset('bundles/minsalsiaps/js/datepicker/jquery.ui.datepicker-es.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/minsalsiaps/js/maskedinput/jquery.maskedinput.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/minsalseguimiento/js/SecIngreso/edit.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/minsalsiaps/js/funciones_generales.js') }}" type="text/javascript"></script>
{%endblock%}

{% block form %}
    {% set url = admin.id(object) ? 'edit' : 'create' %}

    {% if not admin.hasRoute(url)%}
<div>
            {{ "form_not_available"|trans({}, "SonataAdminBundle") }}
    </div>
    {% else %}
    {% include 'MinsalSiapsBundle:MntPacienteAdmin:identificacion_paciente.html.twig' %}

    <a style="position:relative;left:385px" 
       class="btn sonata-action-element" href="{{ path('admin_minsal_siaps_mntpaciente_list') }}">
        <i class="icon-list"></i>
        Buscar Otro Paciente</a>

    <input id="sexo" type="hidden" value="{{ datos.getIdSexo().getId() }}"/>
    <input id="embarazo" type="hidden" value="{{ embarazo }}"/>
    <form id="form_ingreso" class="form-horizontal" action="{{ admin.generateUrl(url, {'id_paciente':datos.getId,'id': admin.id(object), 'uniqid': admin.uniqid, 'subclass': app.request.get('subclass')}) }}" {{ form_enctype(form) }} method="POST">
            {% if form.vars.errors|length > 0 %}
            <div class="sonata-ba-form-error">
                    {{ form_errors(form) }}
                </div>
            {% endif %}
                <div class="tab-content">

                    {% for name, form_group in admin.formgroups %}
                    <div class="tab-pane {% if loop.first %} active{% endif %}" id="{{ admin.uniqid }}_{{ name|sonata_slugify }}">
                        <fieldset>
                            <div class="sonata-ba-collapsed-fields">
                                    {% if form_group.description != false %}
                                    <p>{{ form_group.description|raw }}</p>
                                    {% endif %}

                                    <table class="dat_ingreso" border="0">
                                        <!-- BLOQUE DE REFERERENCIA -->
                                        <tr class="dat_ingreso_sec">
                                            <td colspan="4">EN CASO DE REFERENCIA</td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%' colspan="4">{{form_row(form[form_group.fields.idEstablecimientoReferencia])}}</td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%' colspan="4">{{form_row(form[form_group.fields.motivoReferencia])}}</td>
                                        </tr>
                                        <!-- BLOQUE DE INGRESO -->
                                        <tr class="dat_ingreso_sec">
                                            <td colspan="4">DATOS DE INGRESO</td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%'>{{form_row(form[form_group.fields.idProcedenciaIngreso])}}</td>
                                            <td >{{form_row(form[form_group.fields.idCircunstanciaIngreso])}}</td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%'>{{form_row(form[form_group.fields.fecha])}}</td>
                                            <td >{{form_row(form[form_group.fields.hora])}}</td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%'>{{form_row(form[form_group.fields.embarazada])}}</td>
                                            <td ></td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%'>{{form_row(form[form_group.fields.semanasAmenorrea])}}</td>
                                            <td >{{form_row(form[form_group.fields.fechaProbableParto])}}</td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%' colspan=4>{{form_row(form[form_group.fields.diagnostico])}}</td>

                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%'>{{form_row(form[form_group.fields.idTipoAccidente])}}</td>
                                            <td >{{form_row(form[form_group.fields.idEmpleado])}}</td>
                                        </tr>
                                        <tr class="dat_ingreso_content">
                                            <td width='50%'><div class="control-group">
                                                    <label class=" control-label">Responsable de elaborar el ingreso en ESDOMED:</label>
                                                    <div class="controls sonata-ba-field sonata-ba-field-standard-natural "><strong>
                                                            {{ app.user.firstname ~  app.user.lastname}}
                                                                </strong></div>
                                                        </div></td>
                                                    <td ><div class="control-group">
                                                            <label class=" control-label"> Fecha y hora de elaboraci√≥n: </label>
                                                            <div class="controls sonata-ba-field sonata-ba-field-standard-natural "><strong>
                                                            {{ "now"|date("d-M-Y H:i") }}
                                                                        </strong></div>
                                                                </div></td>
                                                        </tr>

                                                    </table>
                                                </div>
                                            </fieldset>
                                        </div>
                    {% endfor %}
                                    </div>

            {% block sonata_post_fieldsets %}
                                </div>
            {% endblock %}

               {{ form_rest(form) }}

            {% block formactions %}
                                <div class="well form-actions">
                    {% if app.request.isxmlhttprequest %}
                        {% if admin.id(object) %}
                                        <input type="submit" class="btn btn-primary" name="btn_update" value="{{ 'btn_update'|trans({}, 'SonataAdminBundle') }}"/>
                        {% else %}
                                        <input type="submit" class="btn" name="btn_create" value="{{ 'btn_create'|trans({}, 'SonataAdminBundle') }}"/>
                        {% endif %}
                    {% else %}
                        {% if admin.supportsPreviewMode %}
                                        <input class="btn btn-info persist-preview" name="btn_preview" type="submit" value="{{ 'btn_preview'|trans({}, 'SonataAdminBundle') }}"/>
                        {% endif %}
                        {% if admin.id(object) %}
                                        <input type="submit" class="btn btn-primary" name="btn_update_and_edit" value="{{ 'btn_update_and_edit_again'|trans({}, 'SonataAdminBundle') }}"/>

                            {% if admin.hasroute('list') %}
                                        <input type="submit" class="btn" name="btn_update_and_list" value="{{ 'btn_update_and_return_to_list'|trans({}, 'SonataAdminBundle') }}"/>
                            {% endif %}

                                        <!--{ if admin.hasroute('delete') and admin.isGranted('DELETE', object) %}
                                            { 'delete_or'|trans({}, 'SonataAdminBundle') }}
                                            <a class="btn btn-danger" href="{ admin.generateObjectUrl('delete', object) }}">{ 'link_delete'|trans({}, 'SonataAdminBundle') }}</a>
                                        { endif %}-->
                        {% else %}
                                        <!--input class="btn btn-primary" type="submit" name="btn_create_and_edit" value="{{ 'btn_create_and_edit_again'|trans({}, 'SonataAdminBundle') }}"/-->
                                        <input type="submit" class="btn btn-primary" name="btn_create_and_list" value="Guardar"/>

                   <!-- <input class="btn" type="submit" name="btn_create_and_create" value="{{ 'btn_create_and_create_a_new_one'|trans({}, 'SonataAdminBundle') }}"/>-->
                        {% endif %}
                    {% endif %}
                                    </div>
            {% endblock formactions %}
                                </form>
    {% endif%}

{% endblock %}